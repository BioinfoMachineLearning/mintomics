Testing DataLoader 0:   0%|                                                                                                           | 0/1 [00:00<?, ?it/s]torch.Size([1, 2406]) torch.Size([1, 2406])
Testing DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  1.94it/s]          Unnamed: 0  IU_2.5preg_n1  IU_2.5preg_n2  IU_2.5preg_n3  IA_2.5preg_n1  IA_2.5preg_n2  IA_2.5preg_n3
0               Xkr4       1.139365       1.381432       0.884084       0.428088       0.544300       0.532467
1            Gm19938       0.000000       0.016648       0.113826       0.062999       0.000000       0.000000
2                Rp1       2.050768       1.913082       2.372558       4.817127       4.925382       4.954973
3              Sox17       7.204096       7.076327       7.302768       5.502545       5.579611       5.426232
4             Mrpl15       3.866865       3.846703       3.912610       3.852092       3.857649       3.860580
...              ...            ...            ...            ...            ...            ...            ...
21185  G530011O06Rik       1.896770       1.412476       2.041767       2.147589       1.440409       1.536936
21186           Asmt       0.000000       0.083149       0.000000       0.104875       0.138588       0.128413
21187          Ddx3y       0.000000       0.016648       0.000000       0.000000       0.015447       0.000000
21188     Gapdh-ps15       0.635023       0.311280       0.523331       0.290103       0.348224       0.390598
21189         Erdr1x       2.429426       2.371682       4.080882       4.435093       1.676475       2.992597
[21190 rows x 7 columns]
  Unnamed: 0  IU_2.5preg_n1  IU_2.5preg_n2  IU_2.5preg_n3  IA_2.5preg_n1  IA_2.5preg_n2  IA_2.5preg_n3
0       Xkr4       1.139365       1.381432       0.884084       0.428088       0.544300       0.532467
1    Gm19938       0.000000       0.016648       0.113826       0.062999       0.000000       0.000000
2        Rp1       2.050768       1.913082       2.372558       4.817127       4.925382       4.954973
3      Sox17       7.204096       7.076327       7.302768       5.502545       5.579611       5.426232
4     Mrpl15       3.866865       3.846703       3.912610       3.852092       3.857649       3.860580
2406
108
torch.Size([1922, 108])
torch.Size([25, 108])
108
       Ywhae     Ywhaz       Pgd  Serpina1a  Serpina1b  Serpina1d     Actg1  ...      Tpi1       Ltf     Ttc38        Ttr      Usp5       Vcl         Gc
0     Ttc21a    Ttc21a    Ttc21a    Cyp2j11    Cyp2j11    Cyp2j11    Ttc21a  ...    Ttc21a    Ttc21a    Ttc21a    Cyp2j11    Ttc21a    Ttc21a    Cyp2j11
1        Ak7       Ak7       Ak7       Drd4       Drd4       Drd4       Ak7  ...       Ak7       Ak7       Ak7       Drd4       Ak7       Ak7       Drd4
2     Ccdc40    Ccdc40    Ccdc40        Pgf        Pgf        Pgf    Ccdc40  ...    Ccdc40    Ccdc40    Ccdc40        Pgf    Ccdc40    Ccdc40        Pgf
3     Dnali1    Dnali1    Dnali1     Wfdc6a     Wfdc6a     Wfdc6a    Dnali1  ...    Dnali1    Dnali1    Dnali1     Wfdc6a    Dnali1    Dnali1     Wfdc6a
4   Mettl7a1     Vwa3a     Vwa3a      Psg17      Psg17      Psg17     Vwa3a  ...     Vwa3a     Vwa3a  Mettl7a1      Psg17  Mettl7a1  AU040972      Psg17
5      Vwa3a  Mettl7a1    Cfap70      Gpr83    Rasgrp1    Rasgrp1  Mettl7a1  ...  Mettl7a1  Mettl7a1     Vwa3a    Rasgrp1     Vwa3a    Cfap70    Rasgrp1
6         Hp    Cfap70  AU040972    Rasgrp1    Ube2ql1      Gpr83    Cfap70  ...    Cfap70    Cfap70        Hp      Gpr83        Hp     Vwa3a      Gpr83
7     Cfap70        Hp  Mettl7a1    Syndig1      Gpr83    Ube2ql1        Hp  ...        Hp        Hp       ND5    Ube2ql1    Cfap70      Drc7    Ube2ql1
8       Drc7      Drc7      Drc7    Ube2ql1    Syndig1    Syndig1  AU040972  ...      Drc7      Drc7     Rn45s    Syndig1      Drc7    Fam47e    Syndig1
9     Fam47e  AU040972        Hp    Unc93a2    Unc93a2    Unc93a2      Drc7  ...  AU040972  AU040972      Eef2    Unc93a2       ND5        Hp    Unc93a2
10       ND5    Fam47e    Fam47e     Ptger2     Ptger2     Ptger2    Fam47e  ...    Fam47e    Fam47e    Cfap70     Ptger2      Eef2  Mettl7a1     Ptger2
11      Eef2     Rn45s    Osbpl3       Artn       Artn       Artn     Rn45s  ...       ND5     Rn45s      Drc7       Artn     Rn45s    Osbpl3       Artn
12     Rn45s       ND5    Lrrc71      Them5      Them5      Them5       ND5  ...      Eef2       ND5    Fam47e      Them5    Fam47e    Lrrc71      Them5
13  AU040972      Eef2    Scarb2  Pla2g10os  Pla2g10os  Pla2g10os      Eef2  ...     Rn45s      Eef2    Scarb2  Pla2g10os  AU040972     Efhc1  Pla2g10os
14    Scarb2    Scarb2     Rn45s        Me3       Sgcg       Sgcg    Scarb2  ...    Scarb2    Scarb2  AU040972        Me3    Scarb2     Acsl3        Me3
15    Lrrc71    Lrrc71      Eef2       Sgcg     Klk1b5        Me3    Osbpl3  ...    Lrrc71    Osbpl3    Lrrc71       Sgcg    Lrrc71  BC051019       Sgcg
16    Osbpl3    Osbpl3       ND5      Clvs2    Slc26a4      Clvs2    Lrrc71  ...    Osbpl3    Lrrc71     Myo1d      Clvs2    Osbpl3    Scarb2      Clvs2
17     Efhc1     Efhc1     Efhc1    Slc26a4    Fam186b     Klk1b5     Efhc1  ...     Efhc1     Efhc1    Osbpl3    Slc26a4     Myo1d     Myo1d    Slc26a4
18     Myo1d     Acsl3     Acsl3     Klk1b5      Clvs2    Slc26a4     Acsl3  ...     Acsl3     Acsl3     Efhc1     Klk1b5     Efhc1     Rn45s     Klk1b5
19     Acsl3     Myo1d  BC051019    Fam186b       Rln1    Fam186b     Myo1d  ...     Myo1d     Myo1d     Acsl3    Fam186b     Acsl3      Eef2    Fam186b
20  BC051019  BC051019     Myo1d     Sel1l2     Sel1l2     Sel1l2  BC051019  ...  BC051019  BC051019      Plat     Sel1l2  BC051019       ND5     Sel1l2
21    Cfap69    Cfap69    Cfap69    Hsd11b1        Me3       Rln1    Cfap69  ...    Cfap69    Cfap69  BC051019       Rln1    Cfap69    Cfap69       Rln1
22      Plat      Plat     Eef2k       Rln1       Batf    Hsd11b1     Eef2k  ...      Plat     Eef2k    Cfap69    Hsd11b1      Plat   Rsph10b    Hsd11b1
23     Eef2k     Eef2k   Rsph10b     Gm4951    Hsd11b1     Gm4951       Nin  ...     Eef2k      Plat    Malat1     Gm4951     Hipk3     Eef2k     Gm4951
24     Hipk3       Nin       Nin       Ccl6     Gm4951       Batf      Plat  ...     Hipk3       Nin      Dkk3       Ccl6     Eef2k       Nin     Dpysl4
[25 rows x 108 columns]
Restoring states from the checkpoint path at /home/aghktb/JOYS_PROJECT/mintomics/Trainings/Mintomics_classify_till_1_5days_1emblay_single_lay_laynorm/mintomics_epoch=02_valid_loss=0.011209.ckpt
Loaded model weights from checkpoint at /home/aghktb/JOYS_PROJECT/mintomics/Trainings/Mintomics_classify_till_1_5days_1emblay_single_lay_laynorm/mintomics_epoch=02_valid_loss=0.011209.ckpt
/home/aghktb/miniconda3/envs/myenv/lib/python3.11/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:224: PossibleUserWarning: The dataloader, test_dataloader 0, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 80 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
Traceback (most recent call last):
  File "/home/aghktb/JOYS_Project/mintomics/Inference.py", line 234, in <module>
    train_mintomics_classifier()
  File "/home/aghktb/JOYS_Project/mintomics/Inference.py", line 231, in train_mintomics_classifier
    trainer.test(model, dataloaders=test_loader, ckpt_path=pest_checkpoint)
  File "/home/aghktb/miniconda3/envs/myenv/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 780, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/aghktb/miniconda3/envs/myenv/lib/python3.11/site-packages/lightning/pytorch/trainer/call.py", line 38, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/aghktb/miniconda3/envs/myenv/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 829, in _test_impl
    results = self._run(model, ckpt_path=self.ckpt_path)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/aghktb/miniconda3/envs/myenv/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1098, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/home/aghktb/miniconda3/envs/myenv/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1174, in _run_stage
    return self._run_evaluate()
           ^^^^^^^^^^^^^^^^^^^^
  File "/home/aghktb/miniconda3/envs/myenv/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1214, in _run_evaluate
    eval_loop_results = self._evaluation_loop.run()
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/aghktb/miniconda3/envs/myenv/lib/python3.11/site-packages/lightning/pytorch/loops/loop.py", line 206, in run
    output = self.on_run_end()
             ^^^^^^^^^^^^^^^^^
  File "/home/aghktb/miniconda3/envs/myenv/lib/python3.11/site-packages/lightning/pytorch/loops/dataloader/evaluation_loop.py", line 180, in on_run_end
    self._evaluation_epoch_end(self._outputs)
  File "/home/aghktb/miniconda3/envs/myenv/lib/python3.11/site-packages/lightning/pytorch/loops/dataloader/evaluation_loop.py", line 288, in _evaluation_epoch_end
    self.trainer._call_lightning_module_hook(hook_name, output_or_outputs)
  File "/home/aghktb/miniconda3/envs/myenv/lib/python3.11/site-packages/lightning/pytorch/trainer/trainer.py", line 1342, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/aghktb/JOYS_Project/mintomics/Inference.py", line 180, in test_epoch_end
    top_values.df.columns = high_proteins
    ^^^^^^^^^^
NameError: name 'top_values' is not defined